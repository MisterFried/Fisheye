import{f as L}from"./fetchData-d989925a.js";function q(e){Array.from(document.querySelectorAll(".photographer-media__legend-likes")).forEach(r=>{r.addEventListener("click",t=>{var f,g,y;const o=(y=(g=(f=t.currentTarget.parentElement)==null?void 0:f.parentElement)==null?void 0:g.firstElementChild)==null?void 0:y.firstElementChild;if(o){let l=0;if(o instanceof HTMLImageElement){const u=o.src.split("/").pop(),h=u==null?void 0:u.slice(0,-13);l=e.findIndex(p=>{var _;return((_=p.image)==null?void 0:_.slice(0,-5))===h})}if(o instanceof HTMLVideoElement){const h=o.firstChild.src.split("/").pop();l=e.findIndex(p=>p.video===h)}i(l)}else console.error("Error : Couldn't find the media associated to the like button");function i(l){e[l].isLiked?(e[l].likes-=1,e[l].isLiked=!1,r.innerHTML=`${e[l].likes} <i class="fa-regular fa-heart" aria-label="likes" ></i>`):(e[l].likes+=1,e[l].isLiked=!0,r.innerHTML=`${e[l].likes} <i class="fa-solid fa-heart" aria-label="likes" ></i>`),C(e)}})})}function C(e){const a=document.querySelector(".photographer-info-bar__likes");let r=0;e.forEach(t=>r+=t.likes),a.innerHTML=`${r} <i class = "fa-solid fa-heart" aria-label="likes"></i>`}function w(e){const a=Array.from(document.querySelectorAll(".photographer-media__image-button-container, .photographer-media__video-button-container")),r=document.querySelector("#mediaModal"),t=document.querySelector(".media-modal__image"),n=document.querySelector(".media-modal__video"),o=document.querySelector(".media-modal__video-source"),i=document.querySelector(".media-modal__legend"),f=document.querySelector(".media-modal__next-icon"),g=document.querySelector(".media-modal__previous-icon");let y="",l="",u="",h="",p=[];a.forEach(d=>{d.addEventListener("click",m=>{r.showModal();const c=m.currentTarget.firstElementChild;c instanceof HTMLImageElement?(l="image",y=`${c.src.slice(0,-13)}.webp`):c instanceof HTMLVideoElement&&(l="video",y=c.firstElementChild.src),p=y.split("/");const s=p.pop();s&&(h=s),u=p.join("/"),_(l,h,u),f.addEventListener("click",M),g.addEventListener("click",b),document.addEventListener("keydown",S)})});const _=(d,m,k)=>{let c="",s;switch(d){case"image":n.style.display="none",o.src="",t.style.display="block",s=e.find(v=>v.image===m),s&&(c=s.title),t.src=`${k}/${m}`,t.alt=`Photo : ${c}`;break;case"video":t.style.display="none",t.src="",t.alt="",n.style.display="block",s=e.find(v=>v.video===m),s&&(c=s.title),o.src=`${k}/${m}`,n.load();break;default:console.error(`Error : ${d} media type not recognized`);break}i.innerText=c},M=()=>I(1),b=()=>I(-1),I=d=>{let m="";t.style.display==="block"&&n.style.display==="none"&&(p=t.src.split("/")),t.style.display==="none"&&n.style.display==="block"&&(p=o.src.split("/"));const k=p.pop();k&&(h=k),u=p.join("/");let c=e.findIndex(s=>s.image===h||s.video===h);if(c+d<=-1?c=e.length:c+d>=e.length&&(c=-1),e[c+d].image){l="image";const s=e[c+d].image;s&&(m=s)}if(e[c+d].video){l="video";const s=e[c+d].video;s&&(m=s)}_(l,m,u)},S=d=>{d.key==="ArrowLeft"&&g.click(),d.key==="ArrowRight"&&f.click()};r.addEventListener("close",()=>{t.src="#",t.style.display="none",o.src="#",n.style.display="none",f.removeEventListener("click",M),g.removeEventListener("click",b),document.removeEventListener("keydown",S)})}function $(e,a){switch(a){case"popular":e.sort((r,t)=>t.likes-r.likes);break;case"date":e.sort((r,t)=>{const n=new Date(r.date),o=new Date(t.date);return n<o?-1:n>o?1:0});break;case"name":e.sort((r,t)=>{const n=r.title.toUpperCase(),o=t.title.toUpperCase();return n<o?-1:n>o?1:0});break;default:console.error("Unknown sort method");break}}async function A(){const e=P();if(e){const a=await L();if(a){const{photographers:r,media:t}=a,n=r.find(i=>i.id===e),o=t.filter(i=>i.photographerId===e);if(n&&o){$(o,"popular"),x(n),B(o,n.price),T(o);const i=document.querySelector(".photographer-media__order-select");i.addEventListener("change",()=>{$(o,i.value),N(),T(o)})}else console.error(`Error : no photographer with ID : ${e}`)}else console.error("Error : couldn't fetch photographers' data")}else console.error("Error : no photographer ID")}A();function P(){const a=new URLSearchParams(window.location.search).get("id");if(a)return Number(a);console.error("Error : No ID parameter")}function x(e){const a=document.querySelector(".photographer-presentation__name"),r=document.querySelector(".photographer-presentation__location"),t=document.querySelector(".photographer-presentation__tagline"),n=document.querySelector(".photographer-presentation__image"),o=document.querySelector(".contact-modal__title");a.innerText=e.name,r.innerText=`${e.city}, ${e.country}`,t.innerText=e.tagline,n.src=`/Fisheye/images/photographers-profile-picture/${e.portrait}`,n.alt=`Photo de profil de ${e.name}`,o.innerText=`Contactez-moi ${e.name}`}function T(e){const a=document.querySelector(".photographer-media__container");e.forEach(r=>{const t=document.createElement("article");if(t.classList.add("photographer-media__media-container"),r.image){const o=D(r);t.appendChild(o)}if(r.video){const o=z(r);t.appendChild(o)}!r.image&&!r.video&&console.error(`Couldn't find the filename for : ${r.title}`);const n=H(r);t.appendChild(n),a==null||a.appendChild(t)}),w(e),q(e)}function D(e){const r=`/Fisheye/images/photographers-media/${e.photographerId}/${e.image}`.slice(0,-5)+"_resized.webp",t=document.createElement("button");t.classList.add("photographer-media__image-button-container"),t.ariaLabel=`Clickez pour ouvrir ${e.title} en grand`;const n=document.createElement("img");return n.classList.add("photographer-media__image"),n.src=r,n.alt=`Photo : ${e.title}`,n.loading="lazy",t.appendChild(n),t}function z(e){const a=`/Fisheye/images/photographers-media/${e.photographerId}/${e.video}`,r=a.slice(0,-4)+"_thumbnail.png",t=document.createElement("button");t.classList.add("photographer-media__video-button-container"),t.ariaLabel=`Clickez pour ouvrir ${e.title} en grand`;const n=document.createElement("video");n.classList.add("photographer-media__video"),n.poster=r;const o=document.createElement("source");return o.src=a,n.appendChild(o),t.appendChild(n),t}function H(e){const a=document.createElement("div");a.classList.add("photographer-media__legend");const r=document.createElement("span");r.classList.add("photographer-media__legend-name"),r.innerText=e.title;const t=document.createElement("button");return t.classList.add("photographer-media__legend-likes"),e.isLiked?t.innerHTML=`${e.likes} <i class="fa-solid fa-heart" aria-label="likes" ></i>`:t.innerHTML=`${e.likes} <i class="fa-regular fa-heart" aria-label="likes" ></i>`,a.append(r,t),a}function B(e,a){const r=document.querySelector(".photographer-info-bar__price");r.innerText=`${a}â‚¬/ jour`,C(e)}function N(){const e=document.querySelector(".photographer-media__container");for(;e!=null&&e.firstChild;)e.removeChild(e.firstChild)}const R=/^[a-z,A-Z]+(([-,', ])?[a-z,A-Z])*$/,U=/^[a-z,A-Z,0-9]+([-,.,_]?[a-z,A-Z,0-9]+)*@{1}[a-z,A-Z]{2,}\.{1}[a-z,A-Z]{2,}$/,E=document.querySelector(".contact-modal__button"),V=document.querySelector("#contactModal");E==null||E.addEventListener("click",()=>{const e=Array.from(document.querySelectorAll(".contact-modal__text-input"));let a=!0;const r={};e.forEach(o=>{const i=document.querySelector(`#${o.name}-incorrect-input`);if(i)switch(o.name){case"firstname":case"lastname":R.test(o.value)?t(o,i):n(i);break;case"email":U.test(o.value)?t(o,i):n(i);break;case"message":o.value!==""?t(o,i):n(i);break}else console.error("Error message null")}),a&&(console.info(r),V.close(),e.forEach(o=>o.value=""));function t(o,i){r[o.name]=o.value,i.style.display="none"}function n(o){a=!1,o.style.display="inline"}});
