import{f}from"./fetchPhotographersData-6b148f26.js";async function _(){const e=k();if(e){const r=await f();if(r){const o=r.photographers,t=r.media,n=o.find(c=>c.id===e);let a=t.filter(c=>c.photographerId===e);if(n&&a.length!==0){const c=g(a,"popular");E(n),L(c,n.price),m(c);const s=document.querySelector(".photographer-media__order-select");s.addEventListener("change",()=>{const i=g(a,s.value);M(),m(i)})}}else console.log("Error : couldn't fetch photographers' data")}else console.log("Error : no photographer ID")}function k(){const r=new URLSearchParams(window.location.search).get("id");if(r)return Number(r)}function E(e){const r=document.querySelector(".photographer-presentation__name"),o=document.querySelector(".photographer-presentation__location"),t=document.querySelector(".photographer-presentation__tagline"),n=document.querySelector(".photographer-presentation__image"),a=document.querySelector(".contact-modal__title");r.innerText=e.name,o.innerText=`${e.city}, ${e.country}`,t.innerText=e.tagline,n.setAttribute("src",`/Fisheye/images/photographers-profile-picture/${e.portrait}`),n.setAttribute("alt",`Photo de profil de ${e.name}`),a.innerText=`Contactez-moi ${e.name}`}function m(e){const r=document.querySelector(".photographer-media__container");e.forEach(o=>{const t=document.createElement("div");t.classList.add("photographer-media__media-container");let n;o.image&&(n=y(o),t.appendChild(n)),o.video&&(n=I(o),t.appendChild(n)),!o.image&&!o.video&&console.log(`Couldn't find the filename for : ${o.title}`);const a=S(o);t.appendChild(a),r.appendChild(t)}),b(),v(e)}function y(e){const o=`/Fisheye/images/photographers-media/${e.photographerId}/${e.image}`.slice(0,-5)+"_resized.webp",t=document.createElement("img");return t.setAttribute("src",o),t.classList.add("photographer-media__image"),t.setAttribute("alt",`Photo : ${e.title}`),t.setAttribute("decoding","async"),t}function I(e){const r=`/Fisheye/images/photographers-media/${e.photographerId}/${e.video}`,o=r.slice(0,-4)+"_thumbnail.png",t=document.createElement("video"),n=document.createElement("source");return t.classList.add("photographer-media__video"),t.setAttribute("poster",o),t.setAttribute("controls",""),n.setAttribute("src",r),t.appendChild(n),t}function S(e){const r=document.createElement("div"),o=document.createElement("span"),t=document.createElement("span");return r.classList.add("photographer-media__legend"),o.classList.add("photographer-media__legend-name"),o.innerText=e.title,t.classList.add("photographer-media__legend-likes"),e.isLiked?t.innerHTML=`${e.likes} <i class="fa-solid fa-heart"></i>`:t.innerHTML=`${e.likes} <i class="fa-regular fa-heart"></i>`,r.append(o,t),r}function L(e,r){const o=document.querySelector(".photographer-info-bar__likes");let t;t=document.querySelector(".photographer-info-bar__price");let n=0;e.forEach(a=>{n+=a.likes}),o.innerHTML=`${n} <i class = "fa-solid fa-heart"></i>`,t.innerText=`${r}â‚¬/ jour`}function u(e){const r=document.querySelector(".photographer-info-bar__likes");let o=0;e.forEach(t=>{o+=t.likes}),r.innerHTML=`${o} <i class = "fa-solid fa-heart"></i>`}function b(){const e=Array.from(document.querySelectorAll(".photographer-media__image")),r=document.querySelector("#imageModal"),o=document.querySelector(".image-modal__image"),t=document.querySelector(".image-modal__legend");e.forEach(n=>{const c=n.src.slice(0,-13)+".webp";n.addEventListener("click",()=>{var i;const s=(i=n.nextElementSibling)==null?void 0:i.firstElementChild;r.showModal(),o.setAttribute("src",c),t.innerText=s.innerText})}),r.addEventListener("cancel",()=>{o.setAttribute("src","#")}),r.addEventListener("close",()=>{o.setAttribute("src","#")})}function g(e,r){switch(r){case"popular":e.sort((o,t)=>t.likes-o.likes);break;case"date":e.sort((o,t)=>{const n=new Date(o.date),a=new Date(t.date);return n<a?-1:n>a?1:0});break;case"name":e.sort((o,t)=>{const n=o.title.toUpperCase(),a=t.title.toUpperCase();return n<a?-1:n>a?1:0});break;default:console.log("Unknown sort method");break}return e}function M(){const e=document.querySelector(".photographer-media__container");for(;e.firstChild;)e.removeChild(e.firstChild)}function v(e){Array.from(document.querySelectorAll(".photographer-media__legend-likes")).forEach(o=>{o.addEventListener("click",t=>{var s;const a=t.target.parentElement.parentElement.firstElementChild;if(a instanceof HTMLImageElement){const d=a.src.split("/").pop().slice(0,-13);e.forEach((l,h)=>{l.image&&l.image.slice(0,-5)===d&&c(h)})}if(a instanceof HTMLVideoElement){const d=(s=a.firstChild.src.split("/").pop())==null?void 0:s.slice(0,-4);e.forEach((l,h)=>{if(l.video){const p=l.video.slice(0,-4);d===p&&c(h)}})}function c(i){e[i].isLiked?(e[i].likes-=1,e[i].isLiked=!1,o.innerHTML=`${e[i].likes} <i class="fa-regular fa-heart"></i>`,u(e)):(e[i].likes+=1,e[i].isLiked=!0,o.innerHTML=`${e[i].likes} <i class="fa-solid fa-heart"></i>`,u(e))}})})}_();const T=document.querySelector(".header__logo");T.addEventListener("click",()=>{window.location.href="/Fisheye/"});
