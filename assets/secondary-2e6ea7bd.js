import{f as E}from"./fetchPhotographersData-c34650fa.js";async function M(){const e=S();if(e){const i=await E();if(i){const t=i.photographers,o=i.media,n=t.find(u=>u.id===e);let r=o.filter(u=>u.photographerId===e);if(n&&r.length!==0){const u=I(r,"popular");T(n),q(u,n.price),v(u);const p=document.querySelector(".photographer-media__order-select");p.addEventListener("change",()=>{const f=I(r,p.value);w(),v(f)})}}else console.log("Error : couldn't fetch photographers' data")}else console.log("Error : no photographer ID")}function S(){const i=new URLSearchParams(window.location.search).get("id");if(i)return Number(i)}function T(e){const i=document.querySelector(".photographer-presentation__name"),t=document.querySelector(".photographer-presentation__location"),o=document.querySelector(".photographer-presentation__tagline"),n=document.querySelector(".photographer-presentation__image"),r=document.querySelector(".contact-modal__title");i.innerText=e.name,t.innerText=`${e.city}, ${e.country}`,o.innerText=e.tagline,n.setAttribute("src",`/Fisheye/images/photographers-profile-picture/${e.portrait}`),n.setAttribute("alt",`Photo de profil de ${e.name}`),r.innerText=`Contactez-moi ${e.name}`}function v(e){const i=document.querySelector(".photographer-media__container");e.forEach(t=>{const o=document.createElement("div");o.classList.add("photographer-media__media-container");let n;t.image&&(n=b(t),o.appendChild(n)),t.video&&(n=$(t),o.appendChild(n)),!t.image&&!t.video&&console.log(`Couldn't find the filename for : ${t.title}`);const r=P(t);o.appendChild(r),i.appendChild(o)}),x(e),D(e)}function b(e){const t=`/Fisheye/images/photographers-media/${e.photographerId}/${e.image}`.slice(0,-5)+"_resized.webp",o=document.createElement("img");return o.src=t,o.classList.add("photographer-media__image"),o.alt=`Photo : ${e.title}`,o.decoding="async",o}function $(e){const i=`/Fisheye/images/photographers-media/${e.photographerId}/${e.video}`,t=i.slice(0,-4)+"_thumbnail.png",o=document.createElement("video"),n=document.createElement("source");return o.classList.add("photographer-media__video"),o.setAttribute("controls",""),o.poster=t,n.src=i,o.appendChild(n),o}function P(e){const i=document.createElement("div"),t=document.createElement("span"),o=document.createElement("span");return i.classList.add("photographer-media__legend"),t.classList.add("photographer-media__legend-name"),t.innerText=e.title,o.classList.add("photographer-media__legend-likes"),e.isLiked?o.innerHTML=`${e.likes} <i class="fa-solid fa-heart"></i>`:o.innerHTML=`${e.likes} <i class="fa-regular fa-heart"></i>`,i.append(t,o),i}function q(e,i){const t=document.querySelector(".photographer-info-bar__likes");let o;o=document.querySelector(".photographer-info-bar__price");let n=0;e.forEach(r=>{n+=r.likes}),t.innerHTML=`${n} <i class = "fa-solid fa-heart"></i>`,o.innerText=`${i}â‚¬/ jour`}function C(e){const i=document.querySelector(".photographer-info-bar__likes");let t=0;e.forEach(o=>{t+=o.likes}),i.innerHTML=`${t} <i class = "fa-solid fa-heart"></i>`}function x(e){const i=Array.from(document.querySelectorAll(".photographer-media__image, .photographer-media__video")),t=document.querySelector("#mediaModal"),o=document.querySelector(".media-modal__image"),n=document.querySelector(".media-modal__video"),r=n.firstElementChild,u=document.querySelector(".media-modal__legend"),p=document.querySelector(".media-modal__next-icon"),f=document.querySelector(".media-modal__previous-icon");let g="",c="",m="";i.forEach(d=>{d.addEventListener("click",l=>{t.showModal();const s=l.target;if(s instanceof HTMLImageElement){g=`${s.src.slice(0,-13)}.webp`,c="image";const h=s.src.split("/");h.splice(-1,1),m=h.join("/")}else if(s instanceof HTMLVideoElement){g=s.firstElementChild.src,c="video";const y=g.split("/");y.splice(-1,1),m=y.join("/")}const a=g.split("/").pop();_(c,a,m)})}),p.addEventListener("click",()=>{let d="";if(o.style.display==="block"&&n.style.display==="none"){const l=o.src.split("/"),s=l.pop();m=l.join("/");let a=e.findIndex(h=>h.image===s);a===e.length-1&&(a=-1),e[a+1].image?(d=e[a+1].image,c="image"):e[a+1].video&&(d=e[a+1].video,c="video")}else if(o.style.display==="none"&&n.style.display==="block"){const l=r.src.split("/"),s=l.pop();m=l.join("/");let a=e.findIndex(h=>h.video===s);a===e.length-1&&(a=-1),e[a+1].image?(d=e[a+1].image,c="image"):e[a+1].video&&(d=e[a+1].video,c="video")}_(c,d,m)}),f.addEventListener("click",()=>{let d="";if(o.style.display==="block"&&n.style.display==="none"){const l=o.src.split("/"),s=l.pop();m=l.join("/");let a=e.findIndex(h=>h.image===s);a===0&&(a=e.length),e[a-1].image?(d=e[a-1].image,c="image"):e[a-1].video&&(d=e[a-1].video,c="video")}else if(o.style.display==="none"&&n.style.display==="block"){const l=r.src.split("/"),s=l.pop();m=l.join("/");let a=e.findIndex(h=>h.video===s);a===0&&(a=e.length),e[a-1].image?(d=e[a-1].image,c="image"):e[a-1].video&&(d=e[a-1].video,c="video")}_(c,d,m)});function _(d,l,s){var h,y;let a="";switch(d){case"image":o.style.display="block",n.style.display="none",o.src=`${s}/${l}`,a=(h=e.find(k=>k.image===l))==null?void 0:h.title;break;case"video":o.style.display="none",n.style.display="block",r.src=`${s}/${l}`,a=(y=e.find(k=>k.video===l))==null?void 0:y.title;break}u.innerText=a}t.addEventListener("close",()=>{o.src="#",o.style.display="none",n.src="#",n.style.display="none"})}function I(e,i){switch(i){case"popular":e.sort((t,o)=>o.likes-t.likes);break;case"date":e.sort((t,o)=>{const n=new Date(t.date),r=new Date(o.date);return n<r?-1:n>r?1:0});break;case"name":e.sort((t,o)=>{const n=t.title.toUpperCase(),r=o.title.toUpperCase();return n<r?-1:n>r?1:0});break;default:console.log("Unknown sort method");break}return e}function w(){const e=document.querySelector(".photographer-media__container");for(;e.firstChild;)e.removeChild(e.firstChild)}function D(e){Array.from(document.querySelectorAll(".photographer-media__legend-likes")).forEach(t=>{t.addEventListener("click",o=>{const r=o.target.parentElement.parentElement.firstElementChild;if(r instanceof HTMLImageElement){const f=r.src.split("/").pop().slice(0,-13),g=e.findIndex(c=>{var m;return((m=c.image)==null?void 0:m.slice(0,-5))===f});u(g)}else if(r instanceof HTMLVideoElement){const f=r.firstChild.src.split("/").pop(),g=e.findIndex(c=>c.video===f);u(g)}function u(p){e[p].isLiked?(e[p].likes-=1,e[p].isLiked=!1,t.innerHTML=`${e[p].likes} <i class="fa-regular fa-heart"></i>`):(e[p].likes+=1,e[p].isLiked=!0,t.innerHTML=`${e[p].likes} <i class="fa-solid fa-heart"></i>`),C(e)}})})}M();const A=document.querySelector(".header__logo");A.addEventListener("click",()=>{window.location.href="/Fisheye/"});
